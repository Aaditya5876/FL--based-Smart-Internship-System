flowchart TD
    A[Server Global Model W_t] --> B[Clients]
    B -->|Broadcast W_t| C1[Client Init local Wc]
    C1 --> D[Train locally on Dc]
    D --> E[Validate compute weight: 1 over lc+eps]
    E --> F[Optional cluster clients]
    F --> G[Send delta Wc and weight]
    G --> H[Server weighted aggregation]
    H --> I[Global update W_t1]
    I --> J[Optional personalization or k-shot]
